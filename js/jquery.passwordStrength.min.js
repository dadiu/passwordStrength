(function(a){a.fn.passwordStrength=function(e){var d=this,f,e,g,b,c;f={judgeType:0,color:["gray","orange"],weak:["123456","123123","456456","789789","asdasd","zxczxc","qweqwe"],tips:{"0":"请输入密码","1":"长度不对","2":"弱密码，建议修改","3":"请输入数字+字母组合",success:"可用"},tipSet:null,eyes:true,eyesArr:["&#xe638;","&#xe639;"],callback:null};e=a.extend(f,e);g={bar:a("<div>").addClass("m_pBar"),levelBar:a("<p>").addClass("m_pLevelBar"),levelColor:a("<span>").addClass("m_pLevelColor").css("background",e.color[1]),eyes:a("<a>").attr("href","javascript:;").addClass("ic_eyes iconfont"),tips:a("<span>").addClass("u_tips").html(e.tips[0])};b={init:function(){d.parent().append(g.bar);g.bar.append(d);if(e.eyes==true){g.eyes.html(e.eyesArr[0]);g.bar.append(g.eyes);if(a.browser.msie&&a.browser.version<=8){g.eyes.hide()}g.eyes.mousedown(function(){a(this).html(e.eyesArr[1]);d.prop("type","text")});g.eyes.mouseup(function(){a(this).html(e.eyesArr[0]);d.prop("type","password")})}if(e.tipSet){g.tips=e.tipSet}else{g.bar.append(g.tips)}g.levelBar.append(g.levelColor);g.bar.append(g.levelBar);d.keyup(function(){b.ver(a(this).val())});if(e.callback){e.callback()}},ver:function(h){var k=h.length,l=e.weak.length,j=0;if(k<6){g.tips.html(e.tips[1]);b.countResult(0);return false}for(;j<l;j++){if(h==e.weak[j]){g.tips.html(e.tips[2]);b.countResult(2);return false}}if(e.judgeType==1&&(c.allNum.test(h)||c.allEn.test(h))){g.tips.html(e.tips[3]);b.countResult(0);return false}b.countScroe(h);g.tips.html(e.tips.success)},countScroe:function(l){var k=0,o=l.length,j=/[a-z]/,i=/[A-Z]/,q=j.test(l),m=i.test(l),p=l.replace(/\D/g,"").length,n=l.replace(/[a-zA-Z0-9]/g,"").length,h=bAbc=bSign=false;if(o<6){k+=0}else{if(o>=6&&o<=10){k+=10}else{if(o>10){k+=25}}}if(q==false&&m==false){k+=0}else{if(q==true&&m==true){k+=25}else{k+=10}}if(p>0&&p<=2){k+=10}else{if(p>2){k+=20}}if(n==1){k+=10}else{if(n>1){k+=25}}if(p>0){h=true}if(q==true||m==true){bAbc=true}if(n>0){bSign=true}if(h&&bSign&&bAbc){k+=5}else{if(!bAbc&&h&&bSign){k+=3}else{if(bAbc&&!h&&bSign){k+=3}else{if(bAbc&&h&&!bSign){k+=2}}}}b.countResult(b.countLevel(k))},countLevel:function(h){var i=0;if(h>=90){i=8}else{if(h>=80&&h<90){i=7}else{if(h>=70&&h<80){i=6}else{if(h>=60&&h<70){i=5}else{if(h>=30&&h<60){i=4}else{if(h>=25&&h<30){i=3}else{if(h>0){i=2}else{if(h=0){i=1}}}}}}}}return i},countResult:function(h){if(h>=5){g.levelColor.animate({width:"100%"},300)}else{if(h==4){g.levelColor.animate({width:"66.7%"},300)}else{if(h>1&&h<4){g.levelColor.animate({width:"33.4%"},300)}else{g.levelColor.animate({width:0},300)}}}}};c={allNum:/^[1-9]\d*$/,allEn:/^[A-Za-z]+$/};b.init(e,g)}})(jQuery);
