(function($){$.fn.passwordStrength=function(options){var defaults,options,domName=this,objs,dfunc;defaults={id:null,color:["gray","orange"],weak:["asdfgh","qwerty","zxcvbn","Password","Passwd","Woaini","Iloveyou","Woaiwojia","521521","5201314","7758521","1314520","1314521","520520","201314","211314","7758258","147258369","159357","123456","1234567","12345678","123456789","654321","123123","123321","123abc"],tips:{"0":"请输入密码","1":"长度不对","2":"弱密码，建议修改","success":"可用"},eyes:true,eyesArr:["&#xe638;","&#xe639;"],len:[6,20],type:0,callback:null};options=$.extend(defaults,options);objs={bar:$("<div>").addClass("m_pBar"),levelBar:$("<p>").addClass("m_pLevelBar"),levelColor:$("<span>").addClass("m_pLevelColor").css("background",options.color[1]),eyes:$("<a>").attr("href","javascript:;").addClass("ic_eyes iconfont"),tips:$("<span>").addClass("u_tips").html(options.tips[0])};dfunc={init:function(){domName.parent().append(objs.bar);objs.bar.append(domName);if(options.eyes==true){objs.eyes.html(options.eyesArr[0]);objs.bar.append(objs.eyes);if($.browser.msie&&$.browser.version<=8.0){objs.eyes.hide();};objs.eyes.mousedown(function(){$(this).html(options.eyesArr[1]);domName.prop("type","text");});objs.eyes.mouseup(function(){$(this).html(options.eyesArr[0]);domName.prop("type","password");});};objs.bar.append(objs.tips);objs.levelBar.append(objs.levelColor);objs.bar.append(objs.levelBar);domName.keyup(function(){dfunc.ver($(this).val());});},ver:function(num){var vLen=num.length,weakList=options["weak"].length,i=0;if(vLen<6){objs.tips.html(options.tips[1]);dfunc.countResult(0);return false;};for(;i<weakList;i++){if(num==options["weak"][i]){objs.tips.html(options.tips[2]);dfunc.countResult(2);return false;};};dfunc.countScroe(num);objs.tips.html(options.tips.success);},countScroe:function(num){var score=0,vLen=num.length,rLit=/[a-z]/,rCap=/[A-Z]/,LitBoo=rLit.test(num),rCapBoo=rCap.test(num),rNumLen=num.replace(/\D/g,"").length,rSignLen=num.replace(/[a-zA-Z0-9]/g,"").length,bStr=bAbc=bSign=false;if(vLen<6){score+=0;}else if(vLen>=6&&vLen<=10){score+=10;}else if(vLen>10){score+=25;};if(LitBoo==false&&rCapBoo==false){score+=0;}else if(LitBoo==true&&rCapBoo==true){score+=25;}else{score+=10;};if(rNumLen>0&&rNumLen<=2){score+=10;}else if(rNumLen>2){score+=20;}
if(rSignLen==1){score+=10;}else if(rSignLen>1){score+=25;}
if(rNumLen>0){bStr=true};if(LitBoo==true||rCapBoo==true){bAbc=true};if(rSignLen>0){bSign=true};if(bStr&&bSign&&bAbc){score+=5;}else if(!bAbc&&bStr&&bSign){score+=3;}else if(bAbc&&!bStr&&bSign){score+=3;}else if(bAbc&&bStr&&!bSign){score+=2;};dfunc.countResult(dfunc.countLevel(score));},countLevel:function(score){var LV=0;if(score>=90){LV=8;}else if(score>=80&&score<90){LV=7;}else if(score>=70&&score<80){LV=6;}else if(score>=60&&score<70){LV=5;}else if(score>=30&&score<60){LV=4;}else if(score>=25&&score<30){LV=3;}else if(score>0){LV=2;}else if(score=0){LV=1;}
return LV;},countResult:function(LV){if(LV>=5){objs.levelColor.animate({"width":"100%"},300);}else if(LV==4){objs.levelColor.animate({"width":"66.7%"},300);}else if(LV>1&&LV<4){objs.levelColor.animate({"width":"33.4%"},300);}else{objs.levelColor.animate({"width":0},300);}}};dfunc.init(options,objs);};})(jQuery);